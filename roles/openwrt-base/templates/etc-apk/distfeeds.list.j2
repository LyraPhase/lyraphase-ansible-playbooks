{% if ansible_distribution_major_version is defined and
      ansible_distribution_major_version == 'snapshot' or
      not ansible_distribution_major_version is defined -%}
{%   set dist_vers = 'snapshots' -%}
{% elif ansible_distribution_major_version is defined -%}
{%   set dist_vers = ansible_distribution_major_version -%}
{% endif -%}
{% if openwrt_release_data is defined and 'distrib_arch' in openwrt_release_data -%}
{%   set dist_arch = openwrt_release_data.distrib_arch -%}
{% else -%}
{#%  Best guess ... ¯\_(ツ)_/¯ %#}
# Warning: Cound not detect DISTRIB_ARCH from /etc/openwrt_release
#          Using best guess according to ansible_architecture
#          Ensure /etc/openwrt_release is configured properly if this is wrong!
{%   set arch_specific_packages = {
       "i386": "i386_pentium4",
       "i686": "i386_pentium-mmx",
       "x86_64": "x86_64",
       "aarch64": "aarch64_generic",
       "aarch64_be": "armeb_xscale",
       "arm": "arm_cortex-a7_neon-vfpv4",
       "armv7l": "arm_cortex-a15_neon-vfpv4",
       "riscv64": "riscv64_riscv64",
       "ppc": "powerpc_464fp",
       "ppc64": "powerpc64_e5500",
       "mips": "mips_24kc",
       "mipsel": "mipsel_mips32",
       "mips64": "mips64_mips64r2",
       "mips64el": "mips64el_mips64r2",
       "loongarch64": "loongarch64_generic"
     }
-%}
{%   set dist_arch = arch_specific_packages[ansible_architecture] -%}
{% endif -%}
{% if openwrt_release_data is defined and 'distrib_target' in openwrt_release_data -%}
{%   set dist_target = openwrt_release_data.distrib_target -%}
{% else -%}
{#%  Best guess ... ¯\_(ツ)_/¯ %#}
# Warning: Cound not detect DISTRIB_TARGET from /etc/openwrt_release
#          Using best guess according to ansible_architecture
#          Ensure /etc/openwrt_release is configured properly if this is wrong!
{%   set arch_target = {
       "i386": "x86/generic",
       "i686": "x86/legacy",
       "x86_64": "x86/64",
       "aarch64": "rockchip/armv8",
       "aarch64_be": "ixp4xx/generic",
       "arm": "ipq40xx/generic",
       "armv7l": "ipq806x/generic",
       "riscv64": "starfive/generic",
       "ppc": "apm821xx/nand",
       "ppc64": "qoriq/generic",
       "mips": "ramips/mt7621",
       "mipsel": "bcm47xx/generic",
       "mips64": "malta/be64",
       "mips64el": "malta/le64",
       "loongarch64": "loongarch64/generic"
     }
-%}
{%   set dist_target = arch_target[ansible_architecture] -%}
{% endif -%}
https://downloads.openwrt.org/{{ dist_vers }}/targets/{{ dist_target }}/packages/packages.adb
https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/base/packages.adb
https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/luci/packages.adb
https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/packages/packages.adb
https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/routing/packages.adb
# https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/telephony/packages.adb
https://downloads.openwrt.org/{{ dist_vers }}/packages/{{ dist_arch }}/video/packages.adb
