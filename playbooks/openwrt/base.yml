---
# This playbook bootstraps an OpenWRT LEDE router with base settings

- name: OpenWRT Base
  hosts: openwrt
  user: root
  gather_facts: "{{ not (ansible_bootstrap | default(false)) }}"
  vars_files:
    - "vars/openwrt-base.yml"

  roles:
    - openwrt-base
#    - openwrt-logrotate
  tasks:
    - name: Install Extra packages
      community.general.opkg:
        name: "{{ item }}"
        state: installed
      with_items:
        - ethtool
#        - ip-full
#        - ca-certificates
#        - ca-bundle
#        - curl
#        - bind-host
#        - bind-dig
#        - bind-libs
#        - ddns-scripts
#        - luci-app-ddns
#        - iptables
#        - ip6tables
#        - iptables-mod-conntrack-extra
#        - logrotate
#        - luci-app-firewall
#        - luci-proto-ipv6
#        - openvpn-openssl
#        - libopenssl
#        - libustream-openssl
#        - libmbedtls
#        - kmod-tun
#        - luci-app-openvpn
#        - luci-proto-ppp
        - luci-app-advanced-reboot
#        - ppp-mod-pppoe
#        - ppp
#        - mdns-utils
#        - mdnsd
#        - mdnsresponder
      tags:
        - opkg_packages
        - packages
        - install_packages
